openapi: 3.0.3
info:
  title: Blytz.live Marketplace API
  description: |
    Comprehensive REST API for Blytz.live Marketplace - Live Auction Platform
    
    Features:
    - User Authentication & Management
    - Product Catalog with Categories
    - Shopping Cart & Order Management
    - Live Auction System
    - Real-time Bidding
    - Admin Dashboard
    
    All times are in UTC unless otherwise specified.
  version: 3.0.0
  contact:
    name: Blytz Ventures Support
    email: support@blytzventures.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080/api/v1
    description: Development server
  - url: https://api.blytz.live/api/v1
    description: Production server

security:
  - BearerAuth: []

paths:
  # Health Check
  /health:
    get:
      tags:
        - System
      summary: System health check
      description: Returns system status and connectivity information
      operationId: getHealth
      responses:
        '200':
          description: System is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  # Authentication
  /auth/register:
    post:
      tags:
        - Authentication
      summary: User registration
      description: Register a new user account
      operationId: registerUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRegisterRequest'
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: User already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticate user and receive JWT tokens
      operationId: loginUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh JWT token
      description: Get new access token using refresh token
      operationId: refreshToken
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid refresh token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/profile:
    get:
      tags:
        - Authentication
      summary: Get user profile
      description: Retrieve authenticated user profile
      operationId: getUserProfile
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User profile retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/change-password:
    post:
      tags:
        - Authentication
      summary: Change password
      description: Update user password
      operationId: changePassword
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangePasswordRequest'
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/logout:
    post:
      tags:
        - Authentication
      summary: User logout
      description: Logout user and invalidate tokens
      operationId: logoutUser
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Logged out successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # Product Management
  /products:
    get:
      tags:
        - Products
      summary: List products with filtering
      description: Get products with advanced filtering, sorting and pagination
      operationId: listProducts
      parameters:
        - name: category_id
          in: query
          description: Filter by category ID
          schema:
            type: string
            format: uuid
        - name: seller_id
          in: query
          description: Filter by seller ID
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          description: Filter by product status
          schema:
            type: string
            enum: [draft, active, sold, cancelled]
        - name: condition
          in: query
          description: Filter by product condition
          schema:
            type: string
            enum: [new, like_new, good, fair]
        - name: min_price
          in: query
          description: Minimum price filter
          schema:
            type: number
            minimum: 0
        - name: max_price
          in: query
          description: Maximum price filter
          schema:
            type: number
            minimum: 0
        - name: search
          in: query
          description: Search term for title and description
          schema:
            type: string
        - name: featured
          in: query
          description: Filter featured products only
          schema:
            type: boolean
        - name: sort_by
          in: query
          description: Sort field
          schema:
            type: string
            enum: [created_at, updated_at, title, starting_price, view_count]
        - name: sort_direction
          in: query
          description: Sort direction
          schema:
            type: string
            enum: [asc, desc]
        - name: page
          in: query
          description: Page number
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: page_size
          in: query
          description: Items per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Products retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedProductResponse'

    post:
      tags:
        - Products
      summary: Create product
      description: Create a new product (seller/admin only)
      operationId: createProduct
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductCreateRequest'
      responses:
        '201':
          description: Product created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /products/{id}:
    get:
      tags:
        - Products
      summary: Get product by ID
      description: Retrieve product details by ID
      operationId: getProductByID
      parameters:
        - name: id
          in: path
          required: true
          description: Product ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Product retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Products
      summary: Update product
      description: Update existing product (owner/admin only)
      operationId: updateProduct
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Product ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductUpdateRequest'
      responses:
        '200':
          description: Product updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductResponse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - not product owner
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Products
      summary: Delete product
      description: Soft delete product (owner/admin only)
      operationId: deleteProduct
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Product ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Product deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '403':
          description: Forbidden - not product owner
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /products/my-products:
    get:
      tags:
        - Products
      summary: List seller's products
      description: Get products owned by authenticated seller
      operationId: listSellerProducts
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: page_size
          in: query
          description: Items per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Seller's products retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedProductResponse'

  # Shopping Cart
  /cart:
    get:
      tags:
        - Shopping Cart
      summary: Get cart details
      description: Retrieve current cart with items and totals
      operationId: getCart
      parameters:
        - name: include_items
          in: query
          description: Include detailed item information
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Cart retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'
        '400':
          description: Cart not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Shopping Cart
      summary: Create cart
      description: Create a new cart (user or guest)
      operationId: createCart
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CartCreateRequest'
      responses:
        '201':
          description: Cart created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'

  /cart/items:
    post:
      tags:
        - Shopping Cart
      summary: Add item to cart
      description: Add product to cart (authenticated users only)
      operationId: addItemToCart
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddItemRequest'
      responses:
        '200':
          description: Item added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'
        '400':
          description: Invalid input or product not available
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /cart/items/{id}:
    put:
      tags:
        - Shopping Cart
      summary: Update item quantity
      description: Update quantity of cart item
      operationId: updateCartItem
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Cart item ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateItemRequest'
      responses:
        '200':
          description: Item updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Shopping Cart
      summary: Remove item from cart
      description: Remove specific item from cart
      operationId: removeItemFromCart
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Cart item ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Item removed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'

  /cart:
    delete:
      tags:
        - Shopping Cart
      summary: Clear cart
      description: Remove all items from cart
      operationId: clearCart
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Cart cleared successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /cart/merge:
    post:
      tags:
        - Shopping Cart
      summary: Merge guest cart to user cart
      description: Transfer items from guest cart to user cart
      operationId: mergeCart
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MergeCartRequest'
      responses:
        '200':
          description: Carts merged successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CartResponse'

  # Order Management
  /orders:
    post:
      tags:
        - Orders
      summary: Create order
      description: Create order from cart
      operationId: createOrder
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderCreateRequest'
      responses:
        '201':
          description: Order created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderResponse'
        '400':
          description: Invalid cart or insufficient stock
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Orders
      summary: List user orders
      description: Get user's orders with pagination
      operationId: listOrders
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          description: Filter by order status
          schema:
            type: string
            enum: [pending, processing, shipped, delivered, cancelled]
        - name: page
          in: query
          description: Page number
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: page_size
          in: query
          description: Items per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Orders retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedOrderResponse'

  /orders/{id}:
    get:
      tags:
        - Orders
      summary: Get order by ID
      description: Retrieve order details
      operationId: getOrderByID
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Order ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Order retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderResponse'
        '404':
          description: Order not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Orders
      summary: Update order status
      description: Update order status (seller/admin only)
      operationId: updateOrderStatus
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Order ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOrderStatusRequest'
      responses:
        '200':
          description: Order status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderResponse'
        '400':
          description: Invalid status or order not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Orders
      summary: Cancel order
      description: Cancel order (pending status only)
      operationId: cancelOrder
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Order ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Order cancelled successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Order cannot be cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /admin/orders/statistics:
    get:
      tags:
        - Admin
      summary: Get order statistics
      description: Get order statistics (admin only)
      operationId: getOrderStatistics
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderStatisticsResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT authentication token

  schemas:
    # Authentication Schemas
    UserRegisterRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: User email address
          example: "user@example.com"
        password:
          type: string
          format: password
          description: User password (min 8 characters)
          example: "password123"
        first_name:
          type: string
          description: First name
          example: "John"
        last_name:
          type: string
          description: Last name
          example: "Doe"

    UserLoginRequest:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          description: User email address
          example: "user@example.com"
        password:
          type: string
          format: password
          description: User password
          example: "password123"

    RefreshTokenRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string
          description: JWT refresh token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

    ChangePasswordRequest:
      type: object
      required:
        - current_password
        - new_password
      properties:
        current_password:
          type: string
          format: password
          description: Current password
          example: "oldpassword123"
        new_password:
          type: string
          format: password
          description: New password (min 8 characters)
          example: "newpassword123"

    AuthResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserResponse'
        access_token:
          type: string
          description: JWT access token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        refresh_token:
          type: string
          description: JWT refresh token
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        expires_in:
          type: integer
          description: Token expiration time in seconds
          example: 3600

    UserResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: User ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        email:
          type: string
          format: email
          description: User email
          example: "user@example.com"
        role:
          type: string
          enum: [buyer, seller, admin]
          description: User role
          example: "buyer"
        first_name:
          type: string
          nullable: true
          description: First name
          example: "John"
        last_name:
          type: string
          nullable: true
          description: Last name
          example: "Doe"
        avatar_url:
          type: string
          format: uri
          nullable: true
          description: Avatar URL
          example: "https://example.com/avatar.jpg"
        phone:
          type: string
          nullable: true
          description: Phone number
          example: "+1234567890"
        email_verified:
          type: boolean
          description: Email verification status
          example: false
        last_login_at:
          type: string
          format: date-time
          nullable: true
          description: Last login timestamp
          example: "2024-01-01T00:00:00Z"
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00Z"

    UserProfileResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserResponse'

    # Product Schemas
    ProductCreateRequest:
      type: object
      required:
        - category_id
        - title
        - starting_price
      properties:
        category_id:
          type: string
          format: uuid
          description: Category ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        title:
          type: string
          description: Product title
          example: "iPhone 15 Pro"
          minLength: 3
          maxLength: 200
        description:
          type: string
          nullable: true
          description: Product description
          example: "Latest iPhone with advanced features"
        condition:
          type: string
          enum: [new, like_new, good, fair]
          nullable: true
          description: Product condition
          example: "new"
        starting_price:
          type: number
          format: float
          description: Starting price for auction
          example: 999.99
          minimum: 0
        reserve_price:
          type: number
          format: float
          nullable: true
          description: Reserve price (must be >= starting_price)
          example: 1200.00
          minimum: 0
        buy_now_price:
          type: number
          format: float
          nullable: true
          description: Buy now price (must be > starting_price)
          example: 1500.00
          minimum: 0
        images:
          type: array
          items:
            type: string
            format: uri
          description: Array of image URLs
          example: ["https://example.com/image1.jpg", "https://example.com/image2.jpg"]
        video_url:
          type: string
          format: uri
          nullable: true
          description: Product video URL
          example: "https://example.com/video.mp4"
        specifications:
          type: object
          nullable: true
          description: Product specifications as JSON object
          example: {"brand": "Apple", "model": "iPhone 15 Pro", "storage": "256GB"}
        shipping_info:
          type: object
          nullable: true
          description: Shipping information as JSON object
          example: {"weight": 0.5, "dimensions": {"length": 15, "width": 8, "height": 1}}
        status:
          type: string
          enum: [draft, active, sold, cancelled]
          default: draft
          description: Product status
          example: "active"
        featured:
          type: boolean
          default: false
          description: Featured product flag
          example: false

    ProductUpdateRequest:
      type: object
      properties:
        category_id:
          type: string
          format: uuid
          description: Category ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        title:
          type: string
          description: Product title
          example: "iPhone 15 Pro"
          minLength: 3
          maxLength: 200
        description:
          type: string
          nullable: true
          description: Product description
          example: "Latest iPhone with advanced features"
        condition:
          type: string
          enum: [new, like_new, good, fair]
          nullable: true
          description: Product condition
          example: "new"
        starting_price:
          type: number
          format: float
          description: Starting price for auction
          example: 999.99
          minimum: 0
        reserve_price:
          type: number
          format: float
          nullable: true
          description: Reserve price (must be >= starting_price)
          example: 1200.00
          minimum: 0
        buy_now_price:
          type: number
          format: float
          nullable: true
          description: Buy now price (must be > starting_price)
          example: 1500.00
          minimum: 0
        images:
          type: array
          items:
            type: string
            format: uri
          description: Array of image URLs
          example: ["https://example.com/image1.jpg", "https://example.com/image2.jpg"]
        video_url:
          type: string
          format: uri
          nullable: true
          description: Product video URL
          example: "https://example.com/video.mp4"
        specifications:
          type: object
          nullable: true
          description: Product specifications as JSON object
          example: {"brand": "Apple", "model": "iPhone 15 Pro", "storage": "256GB"}
        shipping_info:
          type: object
          nullable: true
          description: Shipping information as JSON object
          example: {"weight": 0.5, "dimensions": {"length": 15, "width": 8, "height": 1}}
        status:
          type: string
          enum: [draft, active, sold, cancelled]
          description: Product status
          example: "active"
        featured:
          type: boolean
          description: Featured product flag
          example: false

    ProductResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Product ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        seller_id:
          type: string
          format: uuid
          description: Seller ID
          example: "550e8400-e29b-41d4-a716-446655440001"
        category_id:
          type: string
          format: uuid
          description: Category ID
          example: "550e8400-e29b-41d4-a716-446655440002"
        title:
          type: string
          description: Product title
          example: "iPhone 15 Pro"
        description:
          type: string
          nullable: true
          description: Product description
          example: "Latest iPhone with advanced features"
        condition:
          type: string
          enum: [new, like_new, good, fair]
          nullable: true
          description: Product condition
          example: "new"
        starting_price:
          type: number
          format: float
          description: Starting price for auction
          example: 999.99
        reserve_price:
          type: number
          format: float
          nullable: true
          description: Reserve price
          example: 1200.00
        buy_now_price:
          type: number
          format: float
          nullable: true
          description: Buy now price
          example: 1500.00
        images:
          type: array
          items:
            type: string
            format: uri
          description: Array of image URLs
          example: ["https://example.com/image1.jpg"]
        video_url:
          type: string
          format: uri
          nullable: true
          description: Product video URL
          example: "https://example.com/video.mp4"
        specifications:
          type: object
          nullable: true
          description: Product specifications
          example: {"brand": "Apple", "model": "iPhone 15 Pro"}
        shipping_info:
          type: object
          nullable: true
          description: Shipping information
          example: {"weight": 0.5, "dimensions": {"length": 15, "width": 8, "height": 1}}
        status:
          type: string
          enum: [draft, active, sold, cancelled]
          description: Product status
          example: "active"
        featured:
          type: boolean
          description: Featured product flag
          example: false
        view_count:
          type: integer
          description: Number of views
          example: 42
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00Z"

    PaginatedProductResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/ProductResponse'
        pagination:
          $ref: '#/components/schemas/PaginationInfo'

    # Cart Schemas
    CartCreateRequest:
      type: object
      properties:
        user_id:
          type: string
          format: uuid
          description: User ID (optional for authenticated users)
          example: "550e8400-e29b-41d4-a716-446655440000"

    CartResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Cart ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        user_id:
          type: string
          format: uuid
          nullable: true
          description: User ID (null for guest carts)
          example: "550e8400-e29b-41d4-a716-446655440000"
        token:
          type: string
          description: Cart token for guest carts
          example: "guest-token-12345"
        expires_at:
          type: string
          format: date-time
          description: Cart expiration time
          example: "2024-01-08T00:00:00Z"
        items:
          type: array
          items:
            $ref: '#/components/schemas/CartItemResponse'
        item_count:
          type: integer
          description: Number of unique items
          example: 3
        subtotal:
          type: number
          format: float
          description: Cart subtotal
          example: 2999.97
        total_items:
          type: integer
          description: Total quantity of all items
          example: 5
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00Z"

    CartItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Cart item ID
          example: "550e8400-e29b-41d4-a716-446655440003"
        product_id:
          type: string
          format: uuid
          description: Product ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        quantity:
          type: integer
          description: Quantity
          example: 2
          minimum: 1
          maximum: 10
        added_at:
          type: string
          format: date-time
          description: Item added timestamp
          example: "2024-01-01T00:00:00Z"
        product:
          $ref: '#/components/schemas/ProductResponse'
        line_total:
          type: number
          format: float
          description: Total price for this line item
          example: 1999.98

    AddItemRequest:
      type: object
      required:
        - product_id
        - quantity
      properties:
        product_id:
          type: string
          format: uuid
          description: Product ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        quantity:
          type: integer
          description: Quantity to add
          example: 2
          minimum: 1
          maximum: 10

    UpdateItemRequest:
      type: object
      required:
        - quantity
      properties:
        quantity:
          type: integer
          description: New quantity
          example: 3
          minimum: 1
          maximum: 10

    MergeCartRequest:
      type: object
      required:
        - guest_token
      properties:
        guest_token:
          type: string
          description: Guest cart token
          example: "guest-token-12345"

    # Order Schemas
    OrderCreateRequest:
      type: object
      required:
        - cart_id
        - shipping_address
      properties:
        cart_id:
          type: string
          format: uuid
          description: Cart ID to convert to order
          example: "550e8400-e29b-41d4-a716-446655440000"
        shipping_address:
          $ref: '#/components/schemas/Address'
        billing_address:
          $ref: '#/components/schemas/Address'
        payment_method:
          type: string
          description: Payment method
          example: "credit_card"
        notes:
          type: string
          nullable: true
          description: Order notes
          example: "Please deliver to side door"

    UpdateOrderStatusRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [pending, processing, shipped, delivered, cancelled]
          description: New order status
          example: "processing"

    OrderResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Order ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        user_id:
          type: string
          format: uuid
          description: User ID
          example: "550e8400-e29b-41d4-a716-446655440001"
        status:
          type: string
          enum: [pending, processing, shipped, delivered, cancelled]
          description: Order status
          example: "pending"
        total_amount:
          type: number
          format: float
          description: Total order amount
          example: 1079.99
        subtotal:
          type: number
          format: float
          description: Order subtotal
          example: 999.99
        tax_amount:
          type: number
          format: float
          description: Tax amount
          example: 80.00
        shipping_cost:
          type: number
          format: float
          description: Shipping cost
          example: 0.00
        discount_amount:
          type: number
          format: float
          description: Discount amount
          example: 0.00
        shipping_address:
          $ref: '#/components/schemas/Address'
        billing_address:
          $ref: '#/components/schemas/Address'
        payment_id:
          type: string
          format: uuid
          nullable: true
          description: Payment ID
          example: "550e8400-e29b-41d4-a716-446655440002"
        tracking_number:
          type: string
          nullable: true
          description: Tracking number
          example: "TRACK123456789"
        notes:
          type: string
          nullable: true
          description: Order notes
          example: "Please deliver to side door"
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItemResponse'
        item_count:
          type: integer
          description: Number of items
          example: 3
        total_quantity:
          type: integer
          description: Total quantity
          example: 5
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-01T00:00:00Z"

    OrderItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Order item ID
          example: "550e8400-e29b-41d4-a716-446655440003"
        order_id:
          type: string
          format: uuid
          description: Order ID
          example: "550e8400-e29b-41d4-a716-446655440000"
        product_id:
          type: string
          format: uuid
          description: Product ID
          example: "550e8400-e29b-41d4-a716-446655440001"
        quantity:
          type: integer
          description: Quantity
          example: 2
        unit_price:
          type: number
          format: float
          description: Unit price
          example: 499.99
        total:
          type: number
          format: float
          description: Total price for this item
          example: 999.98
        product:
          $ref: '#/components/schemas/ProductResponse'
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2024-01-01T00:00:00Z"

    PaginatedOrderResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/OrderResponse'
        pagination:
          $ref: '#/components/schemas/PaginationInfo'

    OrderStatisticsResponse:
      type: object
      properties:
        total_orders:
          type: integer
          description: Total number of orders
          example: 150
        total_revenue:
          type: number
          format: float
          description: Total revenue
          example: 150000.00
        pending_orders:
          type: integer
          description: Number of pending orders
          example: 25
        processing_orders:
          type: integer
          description: Number of processing orders
          example: 30
        shipped_orders:
          type: integer
          description: Number of shipped orders
          example: 80
        delivered_orders:
          type: integer
          description: Number of delivered orders
          example: 10
        cancelled_orders:
          type: integer
          description: Number of cancelled orders
          example: 5

    # Address Schema
    Address:
      type: object
      required:
        - first_name
        - last_name
        - address_line1
        - city
        - state
        - postal_code
        - country
      properties:
        first_name:
          type: string
          description: First name
          example: "John"
        last_name:
          type: string
          description: Last name
          example: "Doe"
        company:
          type: string
          nullable: true
          description: Company name
          example: "ACME Corp"
        address_line1:
          type: string
          description: Address line 1
          example: "123 Main St"
        address_line2:
          type: string
          nullable: true
          description: Address line 2
          example: "Apt 4B"
        city:
          type: string
          description: City
          example: "New York"
        state:
          type: string
          description: State/Province
          example: "NY"
        postal_code:
          type: string
          description: Postal/ZIP code
          example: "10001"
        country:
          type: string
          description: Country
          example: "USA"
        phone:
          type: string
          nullable: true
          description: Phone number
          example: "+1234567890"

    # Common Schemas
    PaginationInfo:
      type: object
      properties:
        page:
          type: integer
          description: Current page
          example: 1
        page_size:
          type: integer
          description: Items per page
          example: 20
        total:
          type: integer
          description: Total items
          example: 100
        total_pages:
          type: integer
          description: Total pages
          example: 5

    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Operation completed successfully"

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error message
          example: "Invalid input"
        details:
          type: string
          description: Detailed error information
          example: "Email field is required"

    HealthResponse:
      type: object
      properties:
        status:
          type: string
          description: System status
          example: "ok"
        database:
          type: string
          description: Database connection status
          example: "connected"
        redis:
          type: string
          description: Redis connection status
          example: "connected"
        env:
          type: string
          description: Environment
          example: "development"

tags:
  - name: System
    description: System health and status endpoints
  - name: Authentication
    description: User authentication and management
  - name: Products
    description: Product catalog management
  - name: Shopping Cart
    description: Shopping cart functionality
  - name: Orders
    description: Order management system
  - name: Admin
    description: Administrative functions

externalDocs:
  description: Find more info about Blytz.live API
  url: https://github.com/gmsas95/blytz.live.remake